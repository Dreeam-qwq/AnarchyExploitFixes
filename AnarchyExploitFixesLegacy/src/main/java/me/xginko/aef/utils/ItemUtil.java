package me.xginko.aef.utils;

import de.tr7zw.changeme.nbtapi.NBTItem;
import org.bukkit.inventory.InventoryHolder;
import org.bukkit.inventory.ItemStack;
import org.bukkit.inventory.meta.BlockStateMeta;
import org.jetbrains.annotations.NotNull;

import java.nio.charset.StandardCharsets;

public class ItemUtil {

    public static Iterable<ItemStack> getStoredItems(@NotNull ItemStack itemStack) {
        if (MaterialUtil.INVENTORY_HOLDER_BLOCKS.contains(itemStack.getType())) {
            return ((InventoryHolder) ((BlockStateMeta) itemStack.getItemMeta()).getBlockState()).getInventory();
        }
        return BundleUtil.canCheckBundles() ? BundleUtil.getItems(itemStack) : null;
    }

    public static int getApproximateByteSize(@NotNull ItemStack itemStack, boolean utf16) {
        return new NBTItem(itemStack).toString().getBytes(utf16 ? StandardCharsets.UTF_16 : StandardCharsets.UTF_8).length;
    }

    public static int getApproximateByteSize(@NotNull ItemStack itemStack) {
        return getApproximateByteSize(itemStack, false);
    }
}
