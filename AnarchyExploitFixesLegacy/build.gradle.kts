plugins {
    id("me.moomoo.anarchyexploitfixes.wrapper")
    alias(libs.plugins.shadow)
}

dependencies {
    implementation(project(":Shared"))
    compileOnly(libs.paper12)
    implementation(libs.xseries) // cross-version support
    implementation(libs.hikaricp)
    implementation(libs.caffeineJ8)
}

configure<JavaPluginExtension> {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}

tasks.shadowJar {
    archiveFileName = "${rootProject.name}-${project.name}-${project.version}.${archiveExtension.get()}"
    exclude(
        "LICENSE",
        "META-INF/MANIFEST.MF",
        "META-INF/LICENSE",
        "META-INF/LICENSE.txt",
        "META-INF/NOTICE.txt",
        "com/cryptomorin/xseries/XBiome*",
        "com/cryptomorin/xseries/XEntity*",
        "com/cryptomorin/xseries/XPotion*",
        "com/cryptomorin/xseries/NMSExtras*",
        "com/cryptomorin/xseries/NoteBlockMusic*",
        "com/cryptomorin/xseries/SkullCacheListener*"
    )
    relocate("cloud.commandframework", "me.moomoo.anarchyexploitfixes.libs.commandframework")
    relocate("io.github.thatsmusic99.configurationmaster", "me.moomoo.anarchyexploitfixes.libs.configmaster")
    relocate("org.reflections", "me.moomoo.anarchyexploitfixes.libs.reflections")
    relocate("com.zaxxer", "me.moomoo.anarchyexploitfixes.libs.zaxxer")
    relocate("org.apache.commons.math3", "me.moomoo.anarchyexploitfixes.libs.fastmath")
    relocate("com.github.benmanes.caffeine", "me.moomoo.anarchyexploitfixes.libs.caffeine")
    relocate("io.papermc.lib", "me.moomoo.anarchyexploitfixes.libs.paperlib")
    relocate("de.tr7zw.changeme.nbtapi", "me.moomoo.anarchyexploitfixes.libs.nbtapi")
    relocate("org.bstats", "me.moomoo.anarchyexploitfixes.libs.bstats")
    relocate("com.cryptomorin.xseries", "me.moomoo.anarchyexploitfixes.libs.xseries")
    relocate("com.github.retrooper.packetevents", "me.moomoo.anarchyexploitfixes.libs.packetevents.api")
    relocate("io.github.retrooper.packetevents", "me.moomoo.anarchyexploitfixes.libs.packetevents.impl")
    relocate("net.kyori", "me.moomoo.anarchyexploitfixes.libs.packetevents.kyori")
}
