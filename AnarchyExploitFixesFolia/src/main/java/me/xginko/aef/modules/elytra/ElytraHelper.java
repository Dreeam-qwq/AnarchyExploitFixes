package me.xginko.aef.modules.elytra;

import me.xginko.aef.AnarchyExploitFixes;
import me.xginko.aef.config.Config;
import me.xginko.aef.modules.AEFModule;
import me.xginko.aef.utils.LocationUtil;
import org.bukkit.Location;
import org.bukkit.entity.Player;
import org.bukkit.event.player.PlayerMoveEvent;

public class ElytraHelper implements AEFModule {

    public static final double SPEED_TOLERANCE = 0.02;
    private static ElytraHelper instance;

    public ElytraHelper() {
        instance = this;
    }

    public static ElytraHelper getInstance() {
        return instance;
    }

    @Override
    public String configPath() {
        return "elytra-helper";
    }

    @Override
    public void enable() {
    }

    @Override
    public boolean shouldEnable() {
        Config config = AnarchyExploitFixes.config();
        return config.elytra_enable_at_spawn || config.elytra_enable_global || config.elytra_enable_netherceiling;
    }

    @Override
    public void disable() {
    }

    public double getBlocksPerTick(PlayerMoveEvent event) {
        if (AnarchyExploitFixes.config().elytra_calculate_3D)
            return LocationUtil.getRelDistance3D(event.getTo(), event.getFrom());
        return LocationUtil.getRelDistance2D(event.getTo(), event.getFrom());
    }

    public boolean isInNewChunks(Player player) {
        return player.getChunk().getInhabitedTime() <= 200L;
    }

    public Location getSetbackLocation(PlayerMoveEvent event) {
        return event.getFrom();
    }
}
