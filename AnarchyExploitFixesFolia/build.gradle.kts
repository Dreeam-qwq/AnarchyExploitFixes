plugins {
    id("me.xginko.aef.wrapper")
    alias(libs.plugins.shadow)
    alias(libs.plugins.runpaper)
    alias(libs.plugins.userdev)
}

runPaper.folia.registerTask()

tasks {
    runServer {
        minecraftVersion(libs.versions.runpaperversion.get())
    }
}

dependencies {
    implementation(project(":Shared"))
    compileOnly(libs.folia)
    paperweight.foliaDevBundle(libs.versions.foliabundle.get())
    implementation(libs.caffeineJ17)
}

configure<JavaPluginExtension> {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
}

tasks.shadowJar {
    archiveFileName = "${rootProject.name}-${project.name}-${project.version}.${archiveExtension.get()}"
    relocate("io.github.thatsmusic99.configurationmaster", "me.xginko.aef.libs.configmaster")
    relocate("org.reflections", "me.xginko.aef.libs.reflections")
    relocate("org.apache.commons.math3", "me.xginko.aef.libs.fastmath")
    relocate("com.github.benmanes.caffeine", "me.xginko.aef.libs.caffeine")
    relocate("io.papermc.lib", "me.xginko.aef.libs.paperlib")
    relocate("de.tr7zw.changeme.nbtapi", "me.xginko.aef.libs.nbtapi")
    relocate("org.bstats", "me.xginko.aef.libs.bstats")
}
